<h1>Orders#new</h1>
<p id="notice"><%= notice %></p>

<p>Session Number <%= session[:order_identification] %></p>

<%= link_to "Cancel", @order, method: :delete %>

<%= form_for @order do |f| %>
    <%= f.hidden_field :completed, value: true %>
    <%= f.submit "Complete Order" %>
<% end %>

<hr>

<table>
    <tr>
        <th>Product Name</th>
        <th>Price</th>
        <th span=3></th>
    </tr>
    <% @products.each do |product| %>
        <tr>
            <td><%= product.name %></td>
            <td><%= product.price %></td>
            <td>
                <%= form_for @order_item do |f| %>
                    <%= f.hidden_field :product_id, value: product.id %>
                    <%= f.number_field :quantity, value: 1, min: 1 %>
                    <%= f.number_field :discount, value: 0, min: 0, max: 100 %>
                    <%= f.submit "Add to Order" %>
                <% end %>
            </td>
        </tr>
    <% end %>
</table>


<hr>

<h3>Order Items</h3>

<% if @order.order_items.any? %>
    <table>
        <tr>
            <th>Item</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Total Tax</th>
            <th>Discount</th>
            <th>Subtotal</th>
        </tr>
        <% @order.order_items.each do |item| %>
            <tr>
                <td><%= item.product.name %></td>
                <td><%= item.unit_price %></td>
                <td><%= item.quantity %></td>
                <td><%= item.total_tax %></td>
                <td><%= item.discount %></td>
                <td><%= item.subtotal %></td>
            </tr>
        <% end %>
    </table>

<% end %>